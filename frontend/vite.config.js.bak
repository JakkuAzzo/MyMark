import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import fs from 'fs'
import { constants } from 'crypto'

// Replace with your server's actual IP address
const SERVER_IP = '10.186.95.105';

export default defineConfig({
  base: '/',
  https: {
    key: fs.readFileSync('/Users/nathanbrown-bennett/mymask/server.key'),
    cert: fs.readFileSync('/Users/nathanbrown-bennett/mymask/server.crt'),
    minVersion: 'TLSv1.2', // enforce at least TLS 1.2
    requestCert: false,          // do not request client certificate
    rejectUnauthorized: false,   // do not reject if client isn't authorized
    // Removed custom ciphers settings and secureOptions to use Node defaults:
    // ciphers: [ ... ].join(':'),
    // secureOptions: constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_SSLv2,
    // honorCipherOrder: true,
  },
  plugins: [vue()],
  define: {
    __APP_TITLE__: JSON.stringify('My Mark')
  },
  server: {
    host: '0.0.0.0',
    https: true,
    proxy: {
      '/api': {
        target: `https://${SERVER_IP}:5000`,
        changeOrigin: true,
        secure: false,
      }
    }
  }
})
